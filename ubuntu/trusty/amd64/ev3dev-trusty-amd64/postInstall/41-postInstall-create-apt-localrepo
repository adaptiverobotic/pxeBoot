#!/usr/bin/env bash
# -----------------------------------------------------------------------------
# 41-postInstall-create-apt-localrepo
#
# This is one of a series of scripts that live in /root/postInstall. They are
# placed there to avoid being read by casual users and are intended to be
# executed immediately after the VM is created to set up host specific 
# configuration.
#
# Just creates the basic /etc/atp/sources.list/d/* files needed for this VM
#
# Copyright (C) 2014-2015 Ralph Hempel <rhempel@hempeldesigngroup.com>
#
# See LICENSE for https://github.com/rhempel/pxeBoot
# -----------------------------------------------------------------------------

. /root/postInstall/postInstall-setupvars

# -----------------------------------------------------------------------------

FILE="/etc/apt/sources.list.d/localrepo.list"

echo "Creating new \"${FILE}\""

cat <<END-OF-FILE > "${FILE}"
# -----------------------------------------------------------------------------
# Autogenerated by $0
#
# If you need to change things, consider updating the script or adding
# a custom script to your VM postInstall folder.

deb  [arch=amd64] http://ubuntu.trusty.amd64.${hostDebDomain}:${hostDebPort} ${vmRel} main universe multiverse
deb  [arch=i386 ] http://ubuntu.trusty.i386.${hostDebDomain}:${hostDebPort}  ${vmRel} main universe multiverse

END-OF-FILE

# Note: This is the signing key for my local copies of the repositories
#       needed to build an ev3dev image

apt-key adv --keyserver pgp.mit.edu --recv-keys E7249370

# -----------------------------------------------------------------------------
